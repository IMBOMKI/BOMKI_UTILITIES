(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      7671,        203]
NotebookOptionsPosition[      7256,        183]
NotebookOutlinePosition[      7595,        198]
CellTagsIndexPosition[      7552,        195]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 StyleBox[
  RowBox[{"Calculate", " ", "Sensitivity"}], "Title"]], "Input"],

Cell[BoxData[
 RowBox[{"Calculate", " ", "Sensitivity"}]], "Output",
 CellChangeTimes->{
  3.707096865991557*^9, 3.70709914983666*^9, {3.707099183919558*^9, 
   3.707099210082642*^9}, 3.707113934882453*^9, {3.7071144728934813`*^9, 
   3.707114484355448*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Nb", "=", "10.0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Obs", " ", "=", " ", 
      RowBox[{"Floor", "[", "Nb", "]"}]}], ";"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Obs", " ", "=", " ", "11"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"r_", ",", "x_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"x", "+", "Nb"}], ")"}], "^", "r"}], " ", "*", " ", 
      RowBox[{
       RowBox[{"\[ExponentialE]", "^", 
        RowBox[{"(", 
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{"x", "+", "Nb"}], ")"}]}], ")"}]}], "/", 
       RowBox[{"r", "!"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"g", "[", 
      RowBox[{"r_", ",", "xup_"}], "]"}], ":=", 
     RowBox[{"Integrate", "[", 
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"r", ",", "x"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", "xup"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"Integrate", "[", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"Obs", ",", "x"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "0", ",", "xup"}], "}"}]}], "]"}], "/", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"Obs", ",", "x"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "0", ",", "Infinity"}], "}"}]}], "]"}]}], 
     "\[Equal]", "0.9"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"xroot", " ", "=", " ", 
    RowBox[{"xup", " ", "/.", " ", 
     RowBox[{"FindRoot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Integrate", "[", 
          RowBox[{
           RowBox[{"f", "[", 
            RowBox[{"Obs", ",", "x"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "0", ",", "xup"}], "}"}]}], "]"}], "/", 
         RowBox[{"Integrate", "[", 
          RowBox[{
           RowBox[{"f", "[", 
            RowBox[{"Obs", ",", "x"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "0", ",", "Infinity"}], "}"}]}], "]"}]}], "-", 
        "0.90"}], ",", 
       RowBox[{"{", 
        RowBox[{"xup", ",", "0", ",", "20"}], "}"}], ",", 
       RowBox[{"MaxIterations", "\[Rule]", "1000"}], ",", " ", 
       RowBox[{"AccuracyGoal", "\[Rule]", "Automatic"}], ",", 
       RowBox[{"PrecisionGoal", "->", "10"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Integrate", "[", 
          RowBox[{
           RowBox[{"f", "[", 
            RowBox[{"Obs", ",", "x"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "0", ",", "xup"}], "}"}]}], "]"}], "/", 
         RowBox[{"Integrate", "[", 
          RowBox[{
           RowBox[{"f", "[", 
            RowBox[{"Obs", ",", "x"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "0", ",", "Infinity"}], "}"}]}], "]"}]}], "==", 
        "0.90"}], ",", "xup"}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Integrate", "[", 
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"Obs", ",", "x"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", "Infinity"}], "}"}]}], "]"}], ";"}], 
    "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.707096507066362*^9, 3.707096511947715*^9}, 
   3.7070965914607058`*^9, {3.7070966517933493`*^9, 3.707096682064315*^9}, {
   3.7070967510097322`*^9, 3.70709676032789*^9}, {3.707096821744405*^9, 
   3.7070968764869328`*^9}, {3.707096915996438*^9, 3.707096916867413*^9}, {
   3.7070969592166443`*^9, 3.707096960850892*^9}, {3.707097125621759*^9, 
   3.7070971264196978`*^9}, {3.707097263963698*^9, 3.707097342824366*^9}, {
   3.7070974796799803`*^9, 3.707097523182308*^9}, {3.707097601294832*^9, 
   3.707097660036992*^9}, {3.7070978924583178`*^9, 3.707097905321859*^9}, {
   3.707098377205452*^9, 3.7070984043158083`*^9}, {3.7070986526652393`*^9, 
   3.707098665664412*^9}, {3.707099122242798*^9, 3.7070992918786783`*^9}, {
   3.707099628757934*^9, 3.707099782163396*^9}, {3.707100013352919*^9, 
   3.7071001539508047`*^9}, {3.707100192695333*^9, 3.707100358499977*^9}, {
   3.7071005784269333`*^9, 3.707100723023704*^9}, {3.707100776864563*^9, 
   3.707100780367374*^9}, {3.707100828712034*^9, 3.7071008880410137`*^9}, {
   3.707101082412109*^9, 3.70710108861796*^9}, {3.70710181890731*^9, 
   3.7071018417547817`*^9}, {3.707108446779051*^9, 3.707108545481596*^9}, 
   3.707108768041032*^9, {3.707108812560499*^9, 3.707108830054717*^9}, {
   3.7071088672556343`*^9, 3.7071088941641693`*^9}, {3.707113592349538*^9, 
   3.707113668244487*^9}, {3.7071137186995163`*^9, 3.707113790355439*^9}, {
   3.707113879067355*^9, 3.707113953984621*^9}, {3.707114180201455*^9, 
   3.7071141996780376`*^9}, {3.707114260853697*^9, 3.707114266503078*^9}, {
   3.707114318894149*^9, 3.7071144110362883`*^9}, {3.707114465428493*^9, 
   3.7071144808586187`*^9}, 3.707114545338027*^9, {3.707114619386037*^9, 
   3.707114621176848*^9}, {3.7071153082816277`*^9, 3.7071153142176533`*^9}, {
   3.7071784342482862`*^9, 3.707178481572978*^9}, {3.707178928256781*^9, 
   3.707179013669931*^9}, {3.707179277060618*^9, 3.70717927849203*^9}, {
   3.707179318498785*^9, 3.707179358401548*^9}, {3.707179422930533*^9, 
   3.707179424697083*^9}, {3.7071795434973497`*^9, 3.707179544425137*^9}, {
   3.707179659767626*^9, 3.707179707389782*^9}, {3.707179743142962*^9, 
   3.707179774238052*^9}, {3.707180111018277*^9, 3.7071801112329617`*^9}, {
   3.70718050022139*^9, 3.707180553251401*^9}, {3.70718658914718*^9, 
   3.7071866187218122`*^9}, 3.7071866956098013`*^9, {3.7071893314573298`*^9, 
   3.707189340272839*^9}, {3.707190921246323*^9, 3.7071909751009083`*^9}}],

Cell[BoxData["7.457286844609566`"], "Output",
 CellChangeTimes->{{3.707186607157404*^9, 3.707186619509899*^9}, 
   3.707186696709182*^9, {3.707189334013834*^9, 3.7071893409677258`*^9}, {
   3.7071909219159813`*^9, 3.707190976421036*^9}}]
}, Open  ]]
},
WindowSize->{1920, 979},
WindowMargins->{{0, Automatic}, {Automatic, 11}},
FrontEndVersion->"11.0 for Linux x86 (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 89, 2, 68, "Input"],
Cell[672, 26, 258, 5, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[967, 36, 6033, 139, 240, "Input"],
Cell[7003, 177, 237, 3, 32, "Output"]
}, Open  ]]
}
]
*)

